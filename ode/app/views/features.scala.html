@(features: List[Feature])(form: Form[Features.NewFeatureForm])(values: List[Value])

@main("Ode: Feature Editor") {
  <div class="container-full">
    <div class="row">

      <div class="col-md-3">

        <h3>Features</h3>
        <p>
          <input id="feature-filter" type="text" placeholder="Filter ..." />
        </p>

        @for(feature <- features) {

          <p class="feature-item">
            <a href="#@feature.name" class="feature-name">@feature.name</a>
            <button class="btn btn-xs btn-warning">Delete</button>
          </p>

          <!-- Edit block for individual feature: -->
          <div id="@feature.name" class="edit-feature">

            <div contenteditable="true">
              <h3 class="name" data-name="@feature.name">@feature.name</h3>
            </div>
            <div contenteditable="true">
              <span class="description">@feature.getDescription</span>
            </div>

            @if(feature.getType == "complex") {
              <form role="form" method="POST" action="/features/@feature.name/type">
                <p>
                  <input type="radio" name="type" value="complex"
                         id="type-complex" checked="checked" />
                  <label for="type-complex">complex</label>
                </p>
                <p>
                  <input type="radio" name="type" value="atomic"
                         id="type-atomic"/>
                  <label for="type-atomic">atomic</label>
                </p>
                <p>
                  <button class="btn btn-sm btn-info" type="submit">
                    Update
                  </button>
                </p>
              </form>

              <h4>Features permitted in substructure:</h4>

            } else {
              <form role="form" method="POST" action="/features/@feature.name/type">
                <p>
                  <input type="radio" name="type" value="complex"
                         id="type-complex" />
                  <label for="type-complex">complex</label>
                </p>
                <p>
                  <input type="radio" name="type" value="atomic"
                         id="type-atomic" checked="checked" />
                  <label for="type-atomic">atomic</label>
                </p>
                <p>
                  <button class="btn btn-sm btn-info" type="submit">
                    Update
                  </button>
                </p>
              </form>

              <h4>Permitted values:</h4>

            }

            @for(target <- feature.targets) {
              <p class="target">
                <form role="form" method="POST"
                      action="/features/@feature.name/targets/delete">
                  <div class="target-name">
                    @target
                    <input type="hidden" name="type" value="@feature.getType">
                    <input type="hidden" name="target" value="@target">
                    <button class="btn btn-xs btn-warning" type="submit">
                      Delete
                    </button>
                  </div>
                </form>
              </p>
            }

            <form role="form" method="POST"
                  action="/features/@feature.name/targets">
              <input type="hidden" name="type" value="@feature.getType" />
              <div class="form-group">
                <input class="form-control" type="text" name="target" value="" />
              </div>
              <button class="btn btn-sm btn-info" type="submit">
                Add
              </button>
            </form>

          </div>
        }

        <p>
          <button id="new-feature-button" class="btn btn-info">
            New Feature
          </button>
        </p>

      </div>

      <!-- Block to hold functionality for adding or updating feature: -->
      <div id="interaction-block" class="col-md-6"></div>

      <!-- Block for creating new feature: -->
      <div id="new-feature">
        <h3>Create a new feature</h3>
        @helper.form(routes.Features.createFeature) {
          <p>
            <label for="fname">Name:</label>
            <input type="text" name="name" value="@form("name").value"
                   id="fname" />
          </p>
          <p>
            <label for="fdescription">Description:</label>
            <input type="text" name="description"
                   value="@form("description").value"
                   id="fdescription" />
          </p>
          <p>
            <input type="radio" name="type" value="complex"
                   id="type-complex" />
            <label for="type-complex">complex</label>
          </p>
          <p>
            <input type="radio" name="type" value="atomic"
                   id="type-atomic "/>
            <label for="type-atomic">atomic</label>
          </p>
          <p>
            <button class="btn btn-success" type="submit">
              Save
            </button>
          </p>
        }
      </div>

      <!-- Block for displaying available values: ... -->
      <div id="value-list" class="col-md-3">
        <h3>Values</h3>
        <p>
          <input id="value-filter" type="text" placeholder="Filter ..." />
        </p>
        @for(value <- values) {
          <p>@value.name</p>
        }
      </div>
    </div>

    <!-- Separate row for displaying error messages: -->
    <div class="row">
      @if(flash.contains("success")) {
        <div class="alert alert-success alert-dismissable">
          <button type="button" class="close" data-dismiss="alert"
                  aria-hidden="true">
            &times;
          </button>
          <strong>Success:</strong> @flash.get("success")
        </div>
      }
      @if(flash.contains("error")) {
        <div class="alert alert-danger alert-dismissable">
          <button type="button" class="close" data-dismiss="alert"
                  aria-hidden="true">
            &times;
          </button>
          <strong>Error:</strong> @flash.get("error")
        </div>
      }
    </div>

  </div>
}
